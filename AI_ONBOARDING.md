# AI Onboarding (First Run)

ะญัะฐ ัะฟะฐัะณะฐะปะบะฐ ะดะปั ะปัะฑะพะณะพ ะะ-ะฐะณะตะฝัะฐ ะฟัะธ ะฟะตัะฒะพะผ ะทะฐะฟััะบะต ะฒ ัะตะฟะพะทะธัะพัะธะธ **PLGames-Board**.

---

## ๐ฅ๏ธ ะะะะะงะะ ะะะะฃะะะะะ (ะะะะะ!)

### ะะดะต ัั ัะตะนัะฐั ะฝะฐัะพะดะธัััั

**ะะพะบะฐะปัะฝะฐั Windows ะผะฐัะธะฝะฐ ัะฐะทัะฐะฑะพััะธะบะฐ** โ ะทะดะตัั ะฒะฝะพััััั ะธะทะผะตะฝะตะฝะธั ะธ ะดะพัะฐะฑะฐััะฒะฐะตััั ะฟัะพะตะบั.

### Workflow ัะฐะทัะฐะฑะพัะบะธ

```
โโโโโโโโโโโโโโโโโโโโโโโ     git push     โโโโโโโโโโโโโโโโโโโโโโโ
โ  ะะพะบะฐะปัะฝะฐั ะผะฐัะธะฝะฐ   โ โโโโโโโโโโโโโโโโบ โ   GitHub (main)     โ
โ  (Windows)          โ                  โ                     โ
โ  - Cursor/VS Code   โ                  โ  GitHub Actions     โ
โ  - ะะทะผะตะฝะตะฝะธั ะบะพะดะฐ   โ                  โ  (ัะฑะพัะบะฐ ะพะฑัะฐะทะพะฒ)   โ
โโโโโโโโโโโโโโโโโโโโโโโ                  โโโโโโโโโโโโฌโโโโโโโโโโโ
                                                    โ
                                                    โ docker pull
                                                    โผ
                                         โโโโโโโโโโโโโโโโโโโโโโโ
                                         โ  ะฃะดะฐะปัะฝะฝัะน ัะตัะฒะตั   โ
                                         โ  (Linux, ะดะพะผะฐัะฝะธะน)  โ
                                         โ  - Docker Compose   โ
                                         โ  - Production       โ
                                         โโโโโโโโโโโโโโโโโโโโโโโ
```

### ะฅะฐัะฐะบัะตัะธััะธะบะธ ัะตัะฒะตัะฐ

| ะะฐัะฐะผะตัั | ะะฝะฐัะตะฝะธะต |
|----------|----------|
| CPU | 10 ัะดะตั / 20 ะฟะพัะพะบะพะฒ |
| RAM | 8 GB |
| ะกะฒะพะฑะพะดะฝะพะต ะผะตััะพ | ~30 GB |
| ะะก | Linux |
| ะะฐัะฟะพะปะพะถะตะฝะธะต | ะะพะผะฐัะฝะธะน ัะตัะฒะตั |

### ะัะฐะฒะธะปะฐ ะดะปั ะะ

1. **ะะ ะฟััะฐะนัั ะฟะพะดะบะปััะธัััั ะบ ัะตัะฒะตัั** โ ั ัะตะฑั ะฝะตั ะดะพัััะฟะฐ
2. **ะัะต ะธะทะผะตะฝะตะฝะธั ะดะตะปะฐะน ะปะพะบะฐะปัะฝะพ** โ ะฒ ัะฐะนะปะฐั ััะพะณะพ ัะตะฟะพะทะธัะพัะธั
3. **ะะพัะปะต ะธะทะผะตะฝะตะฝะธะน** โ ะฟะพะปัะทะพะฒะฐัะตะปั ัะฐะผ ะดะตะปะฐะตั `git push` ะธ ะพะฑะฝะพะฒะปัะตั ัะตัะฒะตั
4. **GitHub Actions** โ ะฐะฒัะพะผะฐัะธัะตัะบะธ ัะพะฑะธัะฐะตั Docker ะพะฑัะฐะทั ะฟะพัะปะต push ะฒ main

---

## ๐ ะะะะขะซ ะะะฏ ะะะฃะขะะะ (Port Forwarding)

### ะะฑัะทะฐัะตะปัะฝัะต ะฟะพััั ะดะปั ะพัะบัััะธั ะฝะฐ ัะพััะตัะต

| ะะพัั | ะัะพัะพะบะพะป | ะกะตัะฒะธั | ะะฟะธัะฐะฝะธะต |
|------|----------|--------|----------|
| **80** | TCP | HTTP | Caddy gateway (ัะตะดะธัะตะบั ะฝะฐ HTTPS) |
| **443** | TCP | HTTPS | Caddy gateway (ะพัะฝะพะฒะฝะพะน ะฒะตะฑ-ะดะพัััะฟ) |

### ะะฟัะธะพะฝะฐะปัะฝัะต ะฟะพััั (ะดะปั ะพัะปะฐะดะบะธ)

| ะะพัั | ะัะพัะพะบะพะป | ะกะตัะฒะธั | ะะพะณะดะฐ ะฝัะถะตะฝ |
|------|----------|--------|-------------|
| 3010 | TCP | Backend API | ะััะผะพะน ะดะพัััะฟ ะบ API (ะพะฑััะฝะพ ะฝะต ะฝัะถะตะฝ) |
| 22 | TCP | SSH | ะฃะดะฐะปัะฝะฝะพะต ัะฟัะฐะฒะปะตะฝะธะต ัะตัะฒะตัะพะผ |

### ะะฐะบ ะฝะฐัััะพะธัั Port Forwarding

1. ะะฐะนะดะธ ะฒ ะฐะดะผะธะฝะบั ัะพััะตัะฐ (ะพะฑััะฝะพ `192.168.0.1` ะธะปะธ `192.168.1.1`)
2. ะะฐะนะดะธ ัะฐะทะดะตะป **Port Forwarding** / **NAT** / **ะะธัััะฐะปัะฝัะต ัะตัะฒะตัั**
3. ะะพะฑะฐะฒั ะฟัะฐะฒะธะปะฐ:
   - ะะฝะตัะฝะธะน ะฟะพัั: 80 โ ะะฝัััะตะฝะฝะธะน IP ัะตัะฒะตัะฐ, ะฟะพัั 80
   - ะะฝะตัะฝะธะน ะฟะพัั: 443 โ ะะฝัััะตะฝะฝะธะน IP ัะตัะฒะตัะฐ, ะฟะพัั 443
4. ะกะพััะฐะฝะธ ะธ ะฟะตัะตะทะฐะณััะทะธ ัะพััะตั ะตัะปะธ ััะตะฑัะตััั

### ะัะพะฒะตัะบะฐ ะฟะพัะปะต ะฝะฐัััะพะนะบะธ

```bash
# ะก ะฒะฝะตัะฝะตะณะพ ััััะพะนััะฒะฐ (ัะตะปะตัะพะฝ ัะตัะตะท ะผะพะฑะธะปัะฝัะน ะธะฝัะตัะฝะตั):
curl -v http://ะฒะฐั-ะฒะฝะตัะฝะธะน-ip
curl -v https://ะฒะฐั-ะดะพะผะตะฝ.ru

# ะะปะธ ะฟัะพััะพ ะพัะบัะพะน ะฒ ะฑัะฐัะทะตัะต
```

---

## ๐ ะงัะพ ะฟัะพัะธัะฐัั ัะฝะฐัะฐะปะฐ (ะพะฑัะทะฐัะตะปัะฝะพ ะฒ ััะพะผ ะฟะพััะดะบะต)

1. **`ROADMAP.md`** โ ัะตะบััะธะน ััะฐััั, ะฟัะธะฝัััะต ัะตัะตะฝะธั, ััะพ ัะฐะฑะพัะฐะตั ะธ ััะพ ะฝะต ัะฐะฑะพัะฐะตั
2. **`AI_ONBOARDING.md`** (ััะพั ัะฐะนะป) โ ะบัะฐัะบะฐั ะบะฐััะฐ ะธ ะฝะฐัะฐะปัะฝัะต ะธะฝััััะบัะธะธ
3. **`TECHNICAL_AUDIT.md`** โ ะดะตัะฐะปัะฝัะน ะฐะฝะฐะปะธะท DI, ะฝะฐะนะดะตะฝะฝัะต ะฟัะพะฑะปะตะผั ะธ ัะตัะตะฝะธั
4. **`INSTALLATION_QUICK.md`** โ ะธะฝััััะบัะธั ะดะปั ะบะปะธะตะฝัะพะฒ ะฑะตะท ะพะฟััะฐ
5. **`ARCHITECTURE.md`** โ ะพะฑัะฐั ะฐััะธัะตะบัััะฐ ัะธััะตะผั
6. **`README.md`** โ ะพะฟะธัะฐะฝะธะต ะฟัะพะตะบัะฐ

---

## ๐บ๏ธ ะะฐััะฐ ัะตะฟะพะทะธัะพัะธั

```
plgames/
โโโ Dockerfile           # Multi-stage Docker ัะฑะพัะบะฐ (Builder โ Backend โ Frontend)
โโโ docker-compose.yml   # ะะพะปะฝะฐั ะบะพะฝัะธะณััะฐัะธั ะฒัะตั ัะตัะฒะธัะพะฒ
โโโ packages/
โ   โโโ backend/server/src/
โ   โ   โโโ app.module.ts          # ะะปะฐะฒะฝัะน ะผะพะดัะปั Nest ะฟัะธะปะพะถะตะฝะธั
โ   โ   โโโ core/
โ   โ   โ   โโโ crm/               # CRM ะผะพะดัะปั (resolver, service, models)
โ   โ   โ   โโโ user/              # User ะผะพะดัะปั (resolver, service)
โ   โ   โ   โโโ permission/        # Permission ะผะพะดัะปั (DI, ัะตัะฒะธั ะดะพัััะฟะฐ)
โ   โ   โ   โโโ prisma/            # Prisma ะผะพะดัะปั (ะณะปะพะฑะฐะปัะฝัะน, PrismaClient)
โ   โ   โโโ models/                # ะัะต Models ะดะปั DB (ะณะปะพะฑะฐะปัะฝัะน ModelsModule)
โ   โโโ frontend/        # React ะฒะตะฑ-ะฟัะธะปะพะถะตะฝะธะต
โ   โโโ common/          # ะะฑัะธะต ััะธะปะธัั ะธ ัะธะฟั
โโโ blocksuite/          # ะะตะดะฐะบัะพั ะธ ะบะพะผะฟะพะฝะตะฝัั
โโโ scripts/             # ะัะฟะพะผะพะณะฐัะตะปัะฝัะต ัะบัะธะฟัั (deploy, build, test)
```

---

## ๐ด ะัะธัะธัะตัะบะธะต ะัะพะฑะปะตะผั (ะะะจะะะซ)

### ะัะพะฑะปะตะผะฐ 1: Type-Only Imports ะฒ Constructors
**ะกััั:** `import type { Service }` โ TypeScript ััะธัะฐะตั ะฟัะธ ะบะพะผะฟะธะปััะธะธ โ Nest ะฒะธะดะธั `Object` ะฒะผะตััะพ ะบะปะฐััะฐ โ DI error.

**ะะตัะตะฝะธะต:** ะัะต ัะตัะฒะธัั ะฒ constructors ะดะพะปะถะฝั ะฑััั value-ะธะผะฟะพััะฐะผะธ:
```typescript
// โ ะะะะะะะะะฌะะ:
import type { PrismaClient } from '@prisma/client';

// โ ะะะะะะะฌะะ:
import { PrismaClient } from '@prisma/client';
```

### ะัะพะฑะปะตะผะฐ 2: ะะพะดัะปะธ ะะต ะะผะฟะพััะธัััั Global Providers
**ะกััั:** `PrismaModule` - ะณะปะพะฑะฐะปัะฝัะน, ะฝะพ ะตัะปะธ ะผะพะดัะปั ะฝะต ะธะผะฟะพััะธััะตั ะตะณะพ ัะฒะฝะพ โ ะฟัะพะฒะฐะนะดะตั ะฝะตะดะพัััะฟะตะฝ ะฒ ะบะพะฝัะตะบััะต ะผะพะดัะปั.

**ะะตัะตะฝะธะต:** ะะฐะถะดัะน ะผะพะดัะปั ะะะะะะ ะธะผะฟะพััะธัะพะฒะฐัั ะฒัะต ะฝัะถะฝัะต ะผะพะดัะปะธ ะฒ `imports:`:
```typescript
@Module({
  imports: [PrismaModule, PermissionModule],  // <- ะพะฑัะทะฐัะตะปัะฝะพ
  providers: [MyResolver],
})
```

### ะัะพะฑะปะตะผะฐ 3: PrismaService vs PrismaClient
**ะกััั:** ะ ะฟัะพะตะบัะต ะฝะตั `PrismaService` - ัะพะปัะบะพ `PrismaClient` ะธะท `@prisma/client` ัะตัะตะท `PrismaModule`.

**ะะตัะตะฝะธะต:** ะัะตะณะดะฐ ะธะฝะถะตะบัะธััะน `PrismaClient` (ะฝะต `PrismaService`).

---

## ๐ง ะะฐะทะพะฒัะน ะะปะณะพัะธัะผ ะดะปั ะะ

### 1๏ธโฃ ะัะธ ะะตัะฒะพะผ ะะฐะฟััะบะต
```bash
# ะัะพัะธัะฐะนัะต ะดะพะบัะผะตะฝัะฐัะธั ะฒ ััะพะผ ะฟะพััะดะบะต:
# 1. ROADMAP.md (5 ะผะธะฝ) - ััะพ ะดะตะปะฐะตััั
# 2. TECHNICAL_AUDIT.md (10 ะผะธะฝ) - ััะพ ะฑัะปะพ ัะปะพะผะฐะฝะพ
# 3. ะญัะพ AI_ONBOARDING.md (5 ะผะธะฝ)
# 4. ARCHITECTURE.md (10 ะผะธะฝ) - ะบะฐะบ ััััะพะตะฝะพ
```

### 2๏ธโฃ ะัะธ DI ะัะธะฑะบะต ะฒ ะะพะณะฐั
```typescript
// ะัะธะฑะบะฐ: "Nest can't resolve dependencies of the X (?, Y)"

// ะะตะนััะฒะธั:
1. ะะฟัะตะดะตะปะธ ะบะฐะบะพะน ะฟะฐัะฐะผะตัั "?" (ะฝะตะธะทะฒะตััะฝัะน - ะธะฝะดะตะบั)
2. ะะพัะผะพััะธ constructor X - ะบะฐะบะพะน ะฟะฐัะฐะผะตัั ะฝะฐ ััะพะผ ะธะฝะดะตะบัะต
3. ะัะพะฒะตัั ะธะผะฟะพัั - value ะธะปะธ type?
4. ะัะพะฒะตัั ััะพ ะผะพะดัะปั ะธะผะฟะพััะธััะตั ัะพะดะธัะตะปััะบะธะน ะผะพะดัะปั
5. ะะพะผะผะธั ะธ ะฟัั, ะทะฐัะตะผ ะดะฐะน ะฒัะตะผั CI ัะพะฑัะฐัั ะฝะพะฒัะน ะพะฑัะฐะท
```

### 3๏ธโฃ ะัะธ ะะตะฟะปะพะต ะะฐ ะกะตัะฒะตั
```bash
# ะะ ะกะะะะะะ:
git pull                                  # ะะพะปััะธัั ะบะพะด
docker compose pull backend              # ะะพะปััะธัั ะฝะพะฒัะน ะพะฑัะฐะท ะธะท GHCR
docker compose up -d --force-recreate backend  # ะะตัะตัะพะทะดะฐัั ะบะพะฝัะตะนะฝะตั
docker compose logs -n 100 backend       # ะัะพะฒะตัะธัั ะปะพะณะธ
```

**ะะปัั:** GitHub Actions ัะพะฑะธัะฐะตั ะพะฑัะฐะท ะฐะฒัะพะผะฐัะธัะตัะบะธ. ะะดะธัะต 5-10 ะผะธะฝัั ะฟะพัะปะต push.

---

## โ ะัะธะฑะบะธ ะะพัะพััะต ะั ะฃะถะต ะัะฟัะฐะฒะธะปะธ

| ะะตะทะพะปะฒะตั | ะัะพะฑะปะตะผะฐ | ะะตัะตะฝะธะต | ะะพะผะผะธั |
|----------|---------|--------|--------|
| CrmIssueResolver | PrismaService | โ PrismaClient | cf6fa6055 |
| CrmSprintResolver | PrismaService | โ PrismaClient | 402cf3a9e |
| CrmCommentResolver | PrismaService | โ PrismaClient | 402cf3a9e |
| CrmTimeLogResolver | PrismaService | โ PrismaClient | 402cf3a9e |
| UserManagementResolver | type-only PrismaClient | โ value-import | d7824ab8a |
| UserModule | ะฝะต ะธะผะฟะพััะธััะตั PrismaModule | โ ะดะพะฑะฐะฒะปะตะฝ import | be427c813 |

---

## ๐ ะัะฐะฒะธะปะฐ ะะปั ะะฐะทัะฐะฑะพััะธะบะพะฒ

### ะัะธ ะะพะฑะฐะฒะปะตะฝะธะธ Resolver/Service:

**1. ะะฟัะตะดะตะปะธ ะทะฐะฒะธัะธะผะพััะธ:**
```typescript
@Resolver(() => MyType)
export class MyResolver {
  constructor(
    private readonly service: MyService,
    private readonly models: Models,
    private readonly prisma: PrismaClient
  ) {}
}
```

**2. ะะผะฟะพััั ะดะพะปะถะฝั ะฑััั VALUE (ะฝะต type):**
```typescript
import { MyService } from '../my-service';       // โ value
import { PrismaClient } from '@prisma/client';   // โ value
import { Models } from '../../models';           // โ value

// โ ะะะะะะะ:
import type { MyService } from '../my-service';
```

**3. ะะพะฑะฐะฒั ะฒ ะผะพะดัะปั:**
```typescript
@Module({
  imports: [PrismaModule, MyServiceModule],  // <- ะฒัะต ะทะฐะฒะธัะธะผะพััะธ ะผะพะดัะปะตะน
  providers: [MyResolver, ...],
  exports: [MyResolver],
})
export class MyModule {}
```

**4. ะะตัะตะด ะฟััะตะผ:**
```bash
yarn typecheck          # ะฟัะพะฒะตัะธัั ัะธะฟั
git add .
git commit -m "feat: add MyResolver with proper DI"
git push origin main
```

---

## ๐งช ะะฐะบ ะขะตััะธัะพะฒะฐัั ะะพะบะฐะปัะฝะพ

```bash
# 1. ะกะพะฑะตัะธ backend ะปะพะบะฐะปัะฝะพ
docker compose build --no-cache backend

# 2. ะะฐะฟัััะธ ะฒัั
docker compose down -v
docker compose up -d

# 3. ะัะพะฒะตัั ะปะพะณะธ ะฝะฐ ะพัะธะฑะบะธ DI
docker compose logs -n 200 backend | grep -E "ERROR|Exception|Depend"

# 4. ะัะปะธ ัะธััะพ - ะฟัะพะฒะตัั ะทะดะพัะพะฒัะต:
curl http://localhost:3010/api/healthz
# ะพัะฒะตั ะดะพะปะถะตะฝ ะฑััั: { "status": "ok" } ะธะปะธ ะฟะพัะพะถะต
```

---

## ๐ ะะปั ะะปะธะตะฝัะพะฒ (ะะตะท ะะฟััะฐ)

**ะคะฐะนะป:** `INSTALLATION_QUICK.md`

ะกะพะดะตัะถะธั ะฟะพัะฐะณะพะฒัั ะธะฝััััะบัะธั ะดะปั ัะตั, ะบัะพ:
- ะะต ะทะฝะฐะตั Docker
- ะะต ะทะฝะฐะตั Linux
- ะฅะพัะตั ะฟัะพััะพ ัััะฐะฝะพะฒะธัั ะธ ะธัะฟะพะปัะทะพะฒะฐัั

**One-liner ะดะปั ัััะฐะฝะพะฒะบะธ:**
```bash
curl -sSL https://raw.githubusercontent.com/Leonid1095/PLGames-Board/main/install.sh | bash
```

---

## ๐จ ะะฐะถะฝัะต ะะฐะผะตัะฐะฝะธั

1. **NestJS DI ััะตะฑัะตั runtime ัะธะฟะพะฒ** โ ะธะทะฑะตะณะฐะน `import type { }`ะฒ ะบะพะฝััััะบัะพัะฐั
2. **ะะปะพะฑะฐะปัะฝัะต ะผะพะดัะปะธ ะฒัั ัะฐะฒะฝะพ ััะตะฑััั ัะฒะฝะพะณะพ ะธะผะฟะพััะฐ** โ ะฝะต ะฟะพะปะฐะณะฐะนัั ะฝะฐ @Global()
3. **Docker Compose ะธัะฟะพะปัะทัะตั latest ะพะฑัะฐะท** โ ะฟะพัะปะต ะบะพะผะผะธัะฐ ะถะดะธัะต CI (5-10 ะผะธะฝัั)
4. **ะะตัะฒัะน ะฟัั ะฒ main โ CI ัะพะฑะธัะฐะตั ะพะฑัะฐะท** โ ะฝะฐ ัะตัะฒะตัะต ะธัะฟะพะปัะทัะน `docker compose pull`
5. **ะะต ะผะตะฝัะน ะฒะตััะธะธ Node/Yarn** โ ัะบะฐะทะฐะฝั ะฒ `package.json` ะธ `Dockerfile` ะฝะฐะผะตัะตะฝะฝะพ

---

## ๐ ะัะปะธ ะงัะพ-ัะพ ะกะปะพะผะฐะปะพัั

**ะงะตะบ-ะปะธัั ะพัะปะฐะดะบะธ:**

```bash
# 1. ะะพัะผะพััะตัั ะปะพะณะธ
docker compose logs -n 100 backend | tail -50

# 2. ะะตัะตะทะฐะฟัััะธัั
docker compose restart backend

# 3. ะะพะปะฝะพัััั ะฟะตัะตัะพะทะดะฐัั
docker compose down
docker compose up -d

# 4. ะะตัะตัะพะฑัะฐัั ะปะพะบะฐะปัะฝะพ
docker compose build --no-cache backend
docker compose up -d

# 5. ะัะปะธ ะฝะธัะตะณะพ ะฝะต ะฟะพะผะพะณะปะพ:
# - ะัะพัะธัะฐะนัะต TECHNICAL_AUDIT.md ัะฐะทะดะตะป "DI ะัะธะฑะบะธ"
# - ะะพัะผะพััะธัะต ะฝะฐ ะฟะพัะปะตะดะฝะธะต commits ะฒ GitHub
# - ะัะบัะพะนัะต Issue
```

---

**ะะพัะพะฒะพ! ะขะตะฟะตัั ะฒั ะทะฝะฐะตัะต ะบะฐะบ ัะฐะทะฒะพัะฐัะธะฒะฐัั ะธ ัะธะบัะธัั PLGames Board! ๐**

